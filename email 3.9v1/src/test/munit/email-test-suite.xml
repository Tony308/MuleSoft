<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:core="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd">
	<munit:config name="config" doc:name="MUnit configuration"/>
    <spring:beans>
        <spring:import resource="classpath:email.xml"/>
        <spring:import resource="classpath:global.xml"/>
    </spring:beans>
    <munit:test name="CreateAccount-test" description="Successfully create account" expectException="	" ignore="true">
        <set-payload value="{&quot;username&quot;:&quot;newUser&quot;, &quot;password&quot;:&quot;password&quot;}" doc:name="Set Payload"/>
        <http:request config-ref="NodeAPI" path="/createAccount" method="POST" doc:name="HTTP"/>
        <flow-ref name="EmailProjectFlow" doc:name="emailFlow"/>
        <munit:assert-on-equals expectedValue="#[]" actualValue="#[]" doc:name="Assert Equals"/>
    </munit:test>
    <munit:test name="email-test-suiteTest" description="MUnit Test">
        <set-payload value="{&quot;Hell is&quot;: &quot;REAL BITCH&quot;}" mimeType="application/json" doc:name="Set Payload"/>
        <http:request config-ref="NodeAPI" path="/test" method="POST" doc:name="HTTP"/>
        <flow-ref name="testFlow" doc:name="testFlow"/>
        <munit:assert-on-equals message="Test failed: #[payload]" expectedValue="{&quot;username&quot;:&quot;test&quot;, &quot;password&quot;:&quot;password&quot;}" actualValue="#[payload]" doc:name="Assert Equals"/>
    </munit:test>
    <munit:test name="loginFlowTest" description="Succuessful Login" ignore="true">
        <set-payload value="{&quot;username&quot;:&quot;test&quot;, &quot;password&quot;:&quot;password&quot;}" mimeType="application/json" doc:name="Set Payload"/>
        <http:request config-ref="NodeAPI" path="/login" method="POST" doc:name="HTTP"/>
        <flow-ref name="EmailProjectFlow" doc:name="emailFlow"/>
        <dw:transform-message doc:name="Transform Message" metadata:id="93016ac5-3896-4a2b-8824-ba6b33aa74cd">
            <dw:input-payload doc:sample="sample_data\json.json"/>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
---
{
	id: payload.id,
	recipient: payload.recipient,
	origin: payload.origin,
	subject: payload.subject,
	content: payload.content,
	STATUS: payload.STATUS,
	DELETED: payload.DELETED
}]]></dw:set-payload>
        </dw:transform-message>
        <munit:assert-on-equals message="Test failed: #[payload]" expectedValue="{ &quot;id&quot;: [ 1 ], &quot;recipient&quot;: [ &quot;test&quot; ], &quot;origin&quot;: [ &quot;test4&quot; ], &quot;subject&quot;: [ &quot;SQL Procedure&quot; ], &quot;content&quot;: [ &quot;This body text is added using SQL procedure&quot; ], &quot;STATUS&quot;: [ 0 ], &quot;DELETED&quot;: [ 0 ] }" actualValue="#[payload]" doc:name="Assert Equals"/>
    </munit:test>
</mule>
